{% extends "judgementapp/base.html" %}

{% block content %}

    
    


	   <div class="well">

        <h2><span {% if query.length > 200 %} class="long" {% endif %}>{{ query.qId }} - {{ query.text }}</span> <a style="text-align: right;", href="{% url 'judgementapp.views.query' qId=query.qId %}" class="btn">Back to Query</a></h2>
        
        
    </div>

    <div class="row">
      
      <div class="span3">
      {% if prev %}
        <a href="{% url 'judgementapp.views.document' qId=query.qId docId=prev.document.docId %}" class="btn">Prev Document</a>
      {% endif %}
      </div>

      <div class="span6"><h3 style="text-align: center;">Document "{{ document.docId }}" ({{ rank }} / {{total_rank}}) </h3></div>

      <div class="span3" align="right">
      {% if next %}
        <a href="{% url 'judgementapp.views.document' qId=query.qId docId=next.document.docId %}" class="btn">Next Document</a>
      {% endif %}
      </div>

    </div>


	<div class="row">
        
        <div class="span9" style="height:750px; position:relative;"  id='content'>
          <iframe width="100%" height="100%" src="{{ content }}"></iframe>
        </div>
      
        
        <script>
          // $('div#content').mouseup(function() {
          //     document.getElementById("comment").value = getSelectedText();
          // });

          function getSelectedText() {
              if (window.getSelection) {
                  return window.getSelection().toString();
              } else if (document.selection) {
                  return document.selection.createRange().text;
              }
              return '';
          }

          function captureSelection() {
            textarea = document.getElementById('comment');
            if (textarea.value=='Comments') {
              textarea.value = '';
            }
            if (textarea.value.length > 0) {
              textarea.value = textarea.value + '\n';
            }
            textarea.value = textarea.value + '"' + getSelectedText() + '"';
          }
    </script>

        <div class="span3">
            <form class="form-inline" action="{% url 'judgementapp.views.judge' qId=query.qId docId=document.docId %}" method="post">
                {% csrf_token %}

                {% if query.diseases %}
                  <legend>Relevance Criteria</legend>
                  Relevant documents should contain information allowing the user to understand that they have <em>{{ query.diseases }}</em>.
                {% endif %}

                <legend class="small-bottom-margin">Judgement</legend>
                <div class="control-group" style="margin-top:0px">
                    <label class="radio">
                      <input type="radio" name="relevance" id="relevance1" value="-1" {% if judgement.relevance == -1 %} checked {% endif %}>
                      Unjudged
                    </label><br>
                    <label class="radio">
                     <input type="radio" name="relevance" id="relevance2" value="2" {% if judgement.relevance == 2 %} checked {% endif %}>
                      Highly relevant
                    </label><br>
                    <label class="radio">
                      <input type="radio" name="relevance" id="relevance1" value="1" {% if judgement.relevance == 1 %} checked {% endif %}>
                      Somewhat relevant
                    </label><br>
                    <label class="radio">
                      <input type="radio" name="relevance" id="relevance0" value="0" {% if judgement.relevance == 0 %} checked {% endif %}>
                      Not relevant
                    </label>
                </div>
                <legend class="small-bottom-margin">Understandability</legend>
                Do you think a patient would understand this document?
                <div class="control-group" id="small_margin">
                  <label class="radio">
                      <input type="radio" name="understandability" id="understandabilityUN" value="-1" {% if judgement.readability == -1 %} checked {% endif %}>
                      Unjudged.
                    </label><br>
                    <label class="radio">
                      <input type="radio" name="understandability" id="understandability0" value="0" {% if judgement.understandability == 0 %} checked {% endif %}>
                      It is very hard to understand.
                    </label><br>
                    <label class="radio">
                     <input type="radio" name="understandability" id="understandability1" value="1" {% if judgement.understandability == 1 %} checked {% endif %}>
                      It is not easy hard, but not simple.
                    </label><br>
                    <label class="radio">
                      <input type="radio" name="understandability" id="understandability2" value="2" {% if judgement.understandability == 2 %} checked {% endif %}>
                      It is easy to understand.
                    </label>
                    <label class="radio">
                      <input type="radio" name="understandability" id="understandabilityDN" value="-2" {% if judgement.understandability == -2 %} checked {% endif %}>
                      I cannot decide!
                    </label>

                </div>
                <legend class="small-bottom-margin">Reliability</legend>
                Do you trust on this document?
                <div class="control-group" id="small_margin">
                  <label class="radio">
                      <input type="radio" name="reliability" id="reliabilityUN" value="-1" {% if judgement.reliability == -1 %} checked {% endif %}>
                      Unjudged.
                    </label><br>
                    <label class="radio">
                      <input type="radio" name="reliability" id="reliability0" value="0" {% if judgement.reliability == 0 %} checked {% endif %}>
                      I found some wrong or suspicious information on this page.
                    </label><br>
                    <label class="radio">
                     <input type="radio" name="reliability" id="reliability1" value="1" {% if judgement.reliability == 1 %} checked {% endif %}>
                      I don't   is somewhat technical and difficult to read and understand.
                    </label><br>
                    <label class="radio">
                      <input type="radio" name="reliability" id="reliability2" value="2" {% if judgement.reliability == 2 %} checked {% endif %}>
                      It is somewhat easy to read and understand.
                    </label><br>
                    <label class="radio">
                      <input type="radio" name="reliability" id="reliabilityDN" value="3" {% if judgement.reliability == -2 %} checked {% endif %}>
                      I cannot decide!
                    </label>
                </div>
                <legend>Comment (optional)</legend>
                 <div class="control-group" id="small_margin">
                    
                    <div class="controls">
                      <textarea rows="10" class="span3", id="comment" name="comment">{% if judgement.comment %}{{ judgement.comment }}{% else %}{% endif %}</textarea>
                      <button type="button" class="btn btn-link" id="capture" onclick="captureSelection()">Insert Selected Text</button>
                    </div>
                  </div>
                

                <div class="form-actions">

                    <button type="submit" class="btn btn-primary" size="20">Save</button> {% if next %} <button type="submit" name="next", class="btn btn-primary" size="20">Save & Next</button> {% endif %}
                    
                </div>

            </form>



  </div>
  
        
    </div>


{% endblock %}
